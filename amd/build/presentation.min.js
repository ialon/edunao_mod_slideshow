/**
 * Add navigation functionality to slideshow
 *
 * @module      mod_slideshow/presentation
 * @copyright   2025 Josemaria Bolanos <admin@mako.digital>
 * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define(["qrcode"],(function(e){const t=".slide",s=".prev",i=".next",d=".currentslide",l=".fontsize",n=".overlay",r=".scantoenrol",c=".qrcode",o=".fullscreen",u=".editslide";return{init:function(a){let h=document.querySelector("#slideshow-"+a.cmid),f=h.querySelectorAll(t),L=f.length,v=0,m=h.querySelector(s),y=h.querySelector(i),E=h.querySelector(d),g=h.querySelector(n),q=g.querySelector(r),w=h.querySelector(l),p=h.querySelector(o),S=document.querySelector(u);if(g.setAttribute("style","width: "+h.offsetWidth+"px; height: "+h.offsetWidth*(9/16)+"px;"),g.addEventListener("click",(()=>{g.classList.toggle("hidden")})),a.enrolurl){h.querySelector(c).addEventListener("click",(()=>{g.classList.toggle("hidden")})),new e(q,{text:a.enrolurl,width:.4*h.offsetHeight,height:.4*h.offsetHeight})}document.addEventListener("keyup",(e=>{document.fullscreenElement&&("ArrowLeft"===e.key&&b(),"ArrowRight"===e.key&&k())})),document.addEventListener("fullscreenchange",(()=>{document.fullscreenElement?(h.classList.add("fullscreen"),w.value="300"):(h.classList.remove("fullscreen"),w.value="150"),w.dispatchEvent(new Event("input",{bubbles:!0})),W()})),m.addEventListener("click",(()=>{b()}));const b=()=>{v>0&&(f[v].classList.add("hidden"),f[v-1].classList.remove("hidden"),v--,A())};y.addEventListener("click",(()=>{k()}));const k=()=>{v<L-1&&(f[v].classList.add("hidden"),f[v+1].classList.remove("hidden"),v++,A())};p.addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen():h.requestFullscreen()})),w.addEventListener("input",(function(){h.style.fontSize=this.value+"%"})),S.addEventListener("click",(()=>{x()}));const x=()=>{let e=f[v].getAttribute("data-slideid");window.location.href="/mod/slideshow/edit.php?cm="+a.cmid+"&id="+e},A=()=>{E.innerText=v+1+"/"+L,0===v?m.classList.add("disabled"):m.classList.remove("disabled"),v===L-1?y.classList.add("disabled"):y.classList.remove("disabled")};window.addEventListener("resize",(()=>{W()}),!0);const W=()=>{g.setAttribute("style","width: "+h.offsetWidth+"px; height: "+h.offsetWidth*(9/16)+"px;"),f.forEach((e=>{e.setAttribute("style","height: "+h.offsetWidth*(9/16)+"px;")}))};W()}}}));