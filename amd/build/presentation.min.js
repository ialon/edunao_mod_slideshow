/**
 * Add navigation functionality to slideshow
 *
 * @module      mod_slideshow/presentation
 * @copyright   2025 Josemaria Bolanos <admin@mako.digital>
 * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define([],(function(){const e=".slide",t=".prev",s=".next",d=".currentslide",n=".fullscreen",l=".fontsize",i=".editslide";return{init:function(c){let r=document.querySelector("#slideshow-"+c.cmid),o=r.querySelectorAll(e),u=o.length,a=0,m=r.querySelector(t),v=r.querySelector(s),L=r.querySelector(d),f=r.querySelector(n),h=r.querySelector(l),E=document.querySelector(i);document.addEventListener("keyup",(e=>{document.fullscreenElement&&("ArrowLeft"===e.key&&y(),"ArrowRight"===e.key&&S())})),document.addEventListener("fullscreenchange",(()=>{document.fullscreenElement?(r.classList.add("fullscreen"),h.value="300"):(r.classList.remove("fullscreen"),h.value="150"),h.dispatchEvent(new Event("input",{bubbles:!0}))})),m.addEventListener("click",(()=>{y()})),v.addEventListener("click",(()=>{S()}));const y=()=>{a>0&&(o[a].classList.add("hidden"),o[a-1].classList.remove("hidden"),a--,p())},S=()=>{a<u-1&&(o[a].classList.add("hidden"),o[a+1].classList.remove("hidden"),a++,p())};f.addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen():r.requestFullscreen()})),h.addEventListener("input",(function(){r.style.fontSize=this.value+"%"})),E.addEventListener("click",(()=>{b()}));const b=()=>{let e=o[a].getAttribute("data-slideid");window.location.href="/mod/slideshow/edit.php?cm="+c.cmid+"&id="+e},p=()=>{L.innerText=a+1+"/"+u,0===a?m.classList.add("disabled"):m.classList.remove("disabled"),a===u-1?v.classList.add("disabled"):v.classList.remove("disabled")};window.addEventListener("resize",(()=>{q()}),!0);const q=()=>{console.log("updateSlideHeight"),o.forEach((e=>{e.setAttribute("style","height: "+e.offsetWidth*(9/16)+"px;")}))};q()}}}));